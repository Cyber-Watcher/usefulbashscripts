# =================================================================
#                         БАЗОВЫЕ НАСТРОЙКИ
# =================================================================

# Смена префикса с Ctrl+b на Ctrl+q
set -g prefix C-q
unbind C-b
bind C-q send-prefix

# Быстрая перезагрузка конфига: Ctrl+q, r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Устанавливаем 256 цветов
set -g default-terminal "screen-256color"

# Разрешаем использовать мышь для переключения панелей и изменения их размера
set -g mouse on

# =================================================================
#                       НАВИГАЦИЯ И СПЛИТЫ
# =================================================================

# Навигация по панелям (Ctrl+q, h/j/k/l)
# Использует клавиши, которые не конфликтуют с эмулятором терминала.
bind-key h select-pane -L # Лево (Ctrl+q, h)
bind-key j select-pane -D # Вниз (Ctrl+q, j)
bind-key k select-pane -U # Вверх (Ctrl+q, k)
bind-key l select-pane -R # Право (Ctrl+q, l)

# Переключение окон (Табов): Ctrl+q, Стрелка Влево/Вправо
bind-key Left  select-window -p
bind-key Right select-window -n

# 3. Удобные сплиты: Ctrl+q, | или Ctrl+q, -
bind | split-window -h # Вертикальный сплит
bind - split-window -v # Горизонтальный сплит

# =================================================================
#                      НАСТРОЙКА STATUS LINE
# =================================================================

# Общие настройки стиля
set -g status-position bottom # расположение status line снизу
set -g status-interval 2      # обновление каждые 2 сек
# set -g status-bg '#1C311C'    # Тёмно-зеленый фон
set -g status-bg colour23
set -g status-fg '#FFFFFF'    # Белый текст
set -g status-justify centre

# ЛЕВАЯ ЧАСТЬ: Имя сессии, Пользователь и Хост (Универсально)
# Формат: [S: ИмяСессии] | Пользователь@Хост
set -g status-left-length 40
set -g status-left '#[fg=green]#[bold]S: #S #[fg=white]| #[fg=cyan]#(whoami)#[fg=yellow]@#[fg=cyan]#H'

# ЦЕНТРАЛЬНАЯ ЧАСТЬ: Список окон
# Неактивное окно: Серый фон, белый текст
setw -g window-status-style fg=white,bg='#444444'
setw -g window-status-format ' #I:#W '
# АКТИВНОЕ ОКНО: Используем явный Hex-код для черного (#000000)
# (fg=black часто дает темно-серый, #000000 гарантирует черный)
setw -g window-status-current-style fg='#000000',bg='#54ad88',bold
setw -g window-status-current-format ' #[bg=#54ad88,fg=#000000,bold] #I:#W '

# ПРАВАЯ ЧАСТЬ: CPU и RAM (Универсальный и надежный мониторинг)
set -g status-right-length 100
# Работает в KiTTY и Tilix если локаль по умолчанию
# CPU (Мягкий желтый/золотой: #FFD700)
# RAM (Светло-оранжевый/лососевый: #FF8C69)
# Время (Мягкий пурпурный: #C778DA)
# Дата (Светло-голубой/лазурный: #87CEFA)
# set -g status-right '#[fg=#FFD700]CPU: #(mpstat 1 1 | tail -1 | awk "{print 100 - \$NF}" | cut -d . -f 1)% #[fg=#FF8C69]RAM: #(free -h | awk "/Mem:/ {print \$3\"/\"\$2}") #[fg=white] | #[fg=#C778DA]%H:%M #[fg=#87CEFA]%d.%m.%Y'

# Тоже работает в локали по умолчанию в Tilix и KiTTY
# set -g status-right '#[fg=colour220]CPU: #(mpstat 1 1 | tail -1 | awk "{print 100 - \$NF}" | cut -d . -f 1)% #[fg=colour223]RAM: #(free -h | awk "/Mem:/ {print \$3\"/\"\$2}") #[fg=white] | #[fg=colour81]%H:%M #[fg=colour111]%d.%m.%Y'

# Устранены глюки если локаль не по умолчанию
set -g status-right '#[fg=colour220]CPU: #(LANG=C mpstat 1 1 | tail -1 | awk "{print 100 - \$NF}" | cut -d . -f 1)% #[fg=colour223]RAM: #(LANG=C cat /proc/meminfo | awk "/MemTotal/ {total=\$2} /MemAvailable/ {avail=\$2; used=(total-avail)/1048576; total=total/1048576; printf \"%.1f/%.1fG\", used, total}") #[fg=white] | #[fg=colour81]%H:%M #[fg=colour80]%d.%m.%Y'
